<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    <%= t('pages.captions.products_all') %>
  </h1>
  <ol class="breadcrumb">
    <li class="active">
      <%= link_to t('pages.captions.products_all'),
                  products_path %>
    </li>
  </ol>
</section>

<!-- Main content -->
<section class="content">
  <%= render partial: 'layouts/flash_messages', flash: flash %>

  <div class="row">
    <div class="col-xs-12">
      <div class="box">
        <div class="box-header">
          <h3 class="box-title">
            <%= t('pages.box_titles.products_list') %>
          </h3>
        </div>
        <div class="box-body">
          <div class="row">
            <div class="col-sm-12">
              <table id="products-table"
                     class="table table-striped table-bordered">
                <thead>
                  <tr>
                    <th>
                      <%= t('pages.tables.products.headers.photo') %>
                    </th>
                    <th>
                      <%= t('pages.tables.products.headers.description') %>
                    </th>
                    <th>
                      <%= t('pages.tables.products.headers.price') %>
                    </th>
                  </tr>
                </thead>
                <tbody>
                <% if @products.blank? %>
                  <tr>
                    <td colspan="6">
                      <%= t('table.no_data') %>
                    </td>
                  </tr>
                <% else %>
                  <% @products.each do |product| %>
                    <tr>
                      <td class="product-table-photo-block">
                        <% if product.photo.present? &&
                              product.photo.image_stored? %>
                          <%= image_tag product.photo.image.thumb('x200').url,
                                        class: 'img-responsive product-photo' %>
                        <% else %>
                          <img class="img-responsive product-photo"
                               src="http://placehold.it/200x200">
                        <% end %>
                      </td>
                      <td>
                        <h3>
                          <%= link_to(product.title, product_path(product.id),
                                      id: "product_#{product.id}_show") %>
                        </h3>
                        <p><%= product.description %></p>
                        <% if !!current_user %>
                          <p>
                            <span>
                              <%= link_to(edit_product_path(product.id),
                                          class: 'btn btn-primary btn-flat',
                                          id: "product_#{product.id}_edit") do %>
                                <i class="fa fa-edit"></i>
                              <% end %>
                            </span>
                            <span>
                              <%= link_to({ action: 'destroy',
                                            id: product.id },
                                          method: :delete,
                                          class: 'btn btn-danger btn-flat',
                                          id: "product_#{product.id}_del") do %>
                                <i class="fa fa-trash"></i>
                              <% end %>
                            </span>
                          </p>
                        <% end %>
                      </td>
                      <td style="width: 25%; min-height: 200px;">
                        <h3 class="product-price">
                          <%= product.price.present? ?
                              product.price.to_f / 100 : '?' %> руб.
                        </h3>
                      </td>
                    </tr>
                  <% end %>
                <% end %>
                </tbody>
              </table>
            </div>
          </div>
          <div class="row text-center">
            <div class="col-lg-12">
              <%= will_paginate @products,
                                renderer: BootstrapPagination::Rails %>
            </div>
          </div>
        </div><!-- /.box-body -->
      </div>
    </div>
  </div>
</section><!-- /.content -->